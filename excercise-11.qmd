---
title: "excercise-11"
author: "Joyradyn"
format: html
editor: visual
---

## Prelim

```{r, message=FALSE, warning=FALSE}
library(tidyverse)

f <- "https://raw.githubusercontent.com/difiore/ada-datasets/main/Mammal_lifehistories_v2.txt"

d <- read_csv(f, col_names = TRUE)

head(d)

library(skimr)

skim(d)
colnames(d)

d <- d |>
  separate(col = 1,
           into = c("order", "family", "Genus", "species", "mass_g", 
                    "gestation_mo", "newborn_g", "weaning_mo", "wean_mass_g", 
                    "AFR_mo", "max_life_mo", "litter_size", "litters_per_year", "refs"),
           sep = "\t")
```

Which of the variables are categorical and which are numeric?

```{r, message=FALSE, warning=FALSE}
skim(d)
```


```{r, message=FALSE, warning=FALSE}
for (i in 5:13) {
  d[[i]] <- as.numeric(d[[i]])
}

skim(d)
```

## Step 1

```{r, message=FALSE, warning=FALSE}
d2 <- d %>%
  mutate(across(where(is.numeric), ~ ifelse(. == -999, NA, .)))
```

## Step 2

```{r, message=FALSE, warning=FALSE}
d3 <- d2 |>
  select(-litter_size, -refs)
```

## Step 3

```{r, message=FALSE, warning=FALSE}
d4 <- d3 %>%
  mutate(across(where(is.numeric), log))
```

## Step 4

```{r, message=FALSE, warning=FALSE}
m_gest    <- lm(gestation_mo   ~ mass_g, data = d4, na.action = na.exclude)
m_wean    <- lm(weaning_mo     ~ mass_g, data = d4, na.action = na.exclude)
m_afr     <- lm(AFR_mo         ~ mass_g, data = d4, na.action = na.exclude)
m_life    <- lm(max_life_mo    ~ mass_g, data = d4, na.action = na.exclude)
m_newborn <- lm(newborn_g      ~ mass_g, data = d4, na.action = na.exclude)
m_weanmass<- lm(wean_mass_g    ~ mass_g, data = d4, na.action = na.exclude)

d5 <- d4 %>%
  mutate(
    relGest         = residuals(m_gest),
    relWean         = residuals(m_wean),
    relAFR          = residuals(m_afr),
    relLife         = residuals(m_life),
    relNewbornMass  = residuals(m_newborn),
    relWeaningMass  = residuals(m_weanmass)
  )
```

## Step 5

```{r, message=FALSE, warning=FALSE}
ggplot(d5, aes(x = order, y = relLife)) +
  geom_boxplot() +
  labs(title = "Residual Max Lifespan by Order", x = "Order", y = "Residual Lifespan")+
  theme(axis.text.x = element_text(angle = 90))
```

Which mammalian orders have the highest residual lifespan?

```{r, message=FALSE, warning=FALSE}
ggplot(d5, aes(x = order, y = relNewbornMass)) +
  geom_boxplot() +
  labs(title = "Residual Newborn Mass by Order", x = "Order", y = "Residual Newborn Mass") +
  theme(axis.text.x = element_text(angle = 90))
```

Which mammalian orders have the have highest residual newborn mass?

```{r, message=FALSE, warning=FALSE}
ggplot(d5, aes(x = order, y = relWeaningMass)) +
  geom_boxplot() +
  labs(title = "Residual Weaning Mass by Order", x = "Order", y = "Residual Weaning Mass") +
  theme(axis.text.x = element_text(angle = 90))
```

Which mammalian orders have the have highest residual weaning mass?

## Step 6

```{r, message=FALSE, warning=FALSE}


```


For each of the two response variables, indicate what is the best model overall based on AICc and how many models have a delta AICc of 4 or less?

What variables, if any, appear in all of this set of “top” models?

Calculate and plot the model-averaged coefficients and their CIs across this set of top models.
